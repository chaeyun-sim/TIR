# 9. ëª¨ë˜ ë¦¬ì•¡íŠ¸ ê°œë°œ ë„êµ¬ë¡œ ê°œë°œ ë° ë°°í¬ í™˜ê²½ êµ¬ì¶•í•˜ê¸°

## ğŸ· ë¦¬ì•¡íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë„ì»¤ë¼ì´ì¦ˆí•˜ê¸°
- ì´ì „ì—ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— í•„ìš”í•œ íŒŒì¼ ì„¤ì¹˜ í›„ ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ
- ìš”ì¦˜ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì»¨í…Œì´ë„ˆë¡œ ë§Œë“¤ì–´ ë¹ ë¥´ê²Œ ë°°í¬í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì 
- `Docker`: ì„œë¹„ìŠ¤ ìš´ì˜ì— í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê²©ë¦¬í•´ ì»¨í…Œì´ë„ˆë¡œ ë§Œë“¦

### 9.4.1 ë¦¬ì•¡íŠ¸ ì•±ì„ ë„ì»¤ë¼ì´ì¦ˆí•˜ëŠ” ë°©ë²•
#### ë„ì»¤ë€?
> ëª¨ë˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ êµ¬ì¶•, ê³µìœ , ì‹¤í–‰ì„ ë„ì™€ì£¼ëŠ” í”Œë«í¼

- ì»¨í…Œì´ë„ˆ ë‹¨ìœ„ë¡œ íŒ¨í‚¤ì§•í•˜ê³  ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ ë„ì›€
- ë„ì»¤ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ë°”íƒ•ìœ¼ë¡œ ë…ë¦½ëœ í™˜ê²½ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•¨

#### ë„ì»¤ ìš©ì–´
- ì´ë¯¸ì§€: ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“œëŠ” ë° ì‚¬ìš©ë˜ëŠ” í…œí”Œë¦¿
- ì»¨í…Œì´ë„ˆ: ë„ì»¤ì˜ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•œ ìƒíƒœ
- Dockerfile: ì´ë¯¸ì§€ íŒŒì¼ì„ ë§Œë“¤ì§€ ì •ì˜í•˜ëŠ” íŒŒì¼, ë¹Œë“œ ì‹œ ì´ë¯¸ì§€ êµ¬í˜„
- íƒœê·¸: ì´ë¯¸ì§€ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ë ˆì´ë¸” ê°’
- ë¦¬í¬ì§€í„°ë¦¬: ì´ë¯¸ì§€ë¥¼ ëª¨ì•„ë‘ëŠ” ì €ì¥ì†Œ
- ë ˆì§€ìŠ¤íŠ¸ë¦¬: ë¦¬í¬ì§€í„°ë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì„œë¹„ìŠ¤

#### ìì£¼ ì“°ëŠ” ë„ì»¤ cli ëª…ë ¹ì–´
- `docker build`: Dockerfileë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ëŠ” ì‘ì—…
- `docker push`: ì´ë¯¸ì§€ë‚˜ ë¦¬í¬ì§€í„°ë¦¬ë¥¼ ë„ì»¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì—…ë¡œë“œí•˜ëŠ” ê³¼ì •
- `docker tag`: ì´ë¯¸ì§€ì— íƒœê·¸ë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´
- `docker inspect`: ì´ë¯¸ì§€/ì»¨í…Œì´ë„ˆì˜ ì„¸ë¶€ ì •ë³´ ì¶œë ¥ ëª…ë ¹ì–´
- `docker run`: ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ ìƒˆ ì»¨í…Œì´ë„ˆ ìƒì„± ëª…ë ¹ì–´
- `docker ps`: í˜„ì¬ ê°€ë™ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ëª©ë¡ í™•ì¸ ëª…ë ¹ì–´
- `docker rm`: ì»¨í…Œì´ë„ˆ ì‚­ì œ ëª…ë ¹ì–´

### create-react-appì„ ìœ„í•œ Dockerfile ì‘ì„±í•˜ê¸°
- í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— Dockerfile ìƒì„±
```py
# Build stage
FROM node:18.12.0-alpine3.16 as build

WORKDIR /app

COPY package.json ./package.json
COPY package-lock.json ./package-lock.json

RUN npm ci

COPY . ./

RUN npm run build

# Production stage
FROM nginx:1.23.2-alpine as start

COPY ./nginx/nginx.conf /etc/nginx/nginx.conf
COPY --from=build /app/build /usr/share/nginx/html

EXPOSE 3000

ENTRYPOINT ["nginx", "-g", "daemon off;"]
```

- ë„ì»¤ ì´ë¯¸ì§€ ë¹Œë“œ: `docker build . -t cra:test`
- nginx ê´€ë ¨ ì½”ë“œë¥¼ ì¶”ê°€í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰->ë°°í¬ê°€ ì•„ë‹Œ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ

#### create-next-appì„ ìœ„í•œ Dockerfile ì‘ì„±í•˜ê¸°
- í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— Dockerfile ìƒì„±
```py
# Build stage
FROM node:18.12.0-alpine3.16 as build

WORKDIR /app

COPY package.json ./package.json
COPY package-lock.json ./package-lock.json

RUN npm ci

COPY --from=deps /app/node_modules ./node_modules
COPY . ./

RUN npm run build
```

- next.config.jsì— ë‹¤ìŒ ë‚´ìš© ì¶”ê°€
```ts
/** @type ${import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  swcMinify: true,
  output: 'standalone'  // ì—¬ê¸° ì¶”ê°€
}

module.exports = nextConfig
```

<br />

### 9.4.2 ë„ì»¤ë¡œ ë§Œë“  ì´ë¯¸ì§€ ë°°í¬í•˜ê¸°
#### ë„ì»¤ ì´ë¯¸ì§€ ì—…ë¡œë“œí•˜ê¸°
- Repositories -> Create repository -> `docker tag cra:test yceffort/react:cra-test` -> Push to Hub
#### ë„ì»¤ ì´ë¯¸ì§€ ì‹¤í–‰í•˜ê¸°
1. Google Cloud Platformì— ê°€ì…
2. Google Cloud Registryì— ì´ë¯¸ì§€ í‘¸ì‹œ
3. Cloud Runì—ì„œ ì´ë¯¸ì§€ ì‹¤í–‰
4. CI ì„¤ì •