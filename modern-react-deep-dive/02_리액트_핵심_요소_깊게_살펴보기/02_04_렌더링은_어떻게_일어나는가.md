# 2. 리액트 핵심 요소 깊게 살펴보기

## 🏷 렌더링은 어떻게 일어나는가?

> 브라우저 렌더링: HTML/CSS 리소스 기반 웹페이지에 필요한 UI를 그리는 과정<br />
> 리액트 렌더링: 브라우저가 렌더링에 필요한 DOM 트리를 만드는 과정

<br />

### 2.4.1 리액트의 렌더링이란?

- 컴포넌트의 props/state를 기반으로 UI 구성 및 어떤 DOM 결과를 브라우저에 제공할 것인지 계사하는 과정
- 컴포넌트가 props/state이 없다면JSX 값에 따라 렌더링 발생

<br />

### 2.4.2 리액트의 렌더링이 일어나는 이유

#### 최초 렌더링

- 사용자가 처음 애플리케이션에 진입 시 정보 제공을 위해 최초 렌더링 수행

#### 리렌더링

- 클래스 컴포넌트: setState가 실행되는 경우, forceUpdate가 실행되는 경우
- 함수 컴포넌트: useState의 setter가 실행되는 경우, useReducer의 dispatch가 실행되는 경우
- key props가 변경되는 경우, props가 변경되는 경우, 부모 컴포넌트가 리렌더링될 경우 등

#### key가 필요한 이유 ⭐️

```jsx
export default function App() {
  return (
    <ul>
      {arr.map((item) => (
        <li key={item}>{item}</li>
      ))}
    </ul>
  );
}
```

- 리렌더링이 발생하는 동안 형제 요소들 사이에서 동일한 요소를 식별하기 위해 사용하는 값
- current 트리와 workInProgress 트리 사이에서 컴포넌트 변경을 감지하여 구별해야함
- 두 트리 사이에서 같은 컴포넌트인지 구별하기 위한 값이 바로 `key`
- key가 없다면 파이버 내부의 sibling 인덱스를 기준으로 판단 (경고문 출력)
- key에 임의의 값을 넣으면 렌더링할때마다 변하기 때문에 sibiling 컴포넌트를 명확히 구분할 수 없음

<br />

### 2.4.3 리액트의 렌더링 프로세스

- 컴포넌트 루트에서부터 아래로 이동하면서 업데이트가 필요한 컴포넌트 검색
- 발견 시 클래스 컴포넌트는 render() 실행, 함수 컴포넌트의 경우는 FunctionComponent() 그 자체 호출
- 이후 결과물 저장
- 렌더링 결과물은 JSX 문법으로 구성, 자바스크립트로 컴파일 되면서 React.createElement()를 호출하는 구문으로 변환
- 이런 과정을 거쳐 실제 DOM에 반영하기 위한 모든 변경 사항을 수집함 => `재조정 (recoiliation)`

<br />

### 2.4.4 렌더와 커밋

- 렌더 단계(Render Phase): 컴포넌트를 렌더링하고 변경 사항을 계산하는 모든 작업
- 커밋 단계(Commit Phase): 렌더 단계의 변경 사항을 실제 DOM에 적용해 사용자에게 표시하는 과정
- 전체 과정
  1. DOM을 커밋 단계에서 업데이트
  2. DOM 노드 및 인스턴스를 가리키도록 리액트 내부 참조 업데이트
  3. 클래스 컴포넌트는 componentDidMount, componentDidUpdate 호출
  4. 함수 컴포넌트는 useLayoutEffect 호출

#### 렌더링 발생 !== 무조건 DOM 업데이트

- 아무런 변경사항이 감지되지 않는다면 커밋 단계 생략 가능

<br />
